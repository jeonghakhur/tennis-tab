---
name: commit
description: 변경사항을 분석하여 프로젝트 커밋 컨벤션에 맞는 커밋을 생성합니다.
allowed-tools: Bash, Glob, Grep, Read
argument-hint: "[선택사항: 커밋 메시지 힌트]"
---

# Git Commit 스킬

변경사항을 분석하고 프로젝트 컨벤션에 맞는 커밋을 생성한다.

## 커밋 메시지 컨벤션

이 프로젝트의 커밋 메시지 스타일:

- **언어**: 한국어
- **형식**: 간결한 서술형 (1줄 요약)
- **내용**: 변경의 "무엇"과 "왜"를 담음
- **보조 정보**: 필요 시 `+` 구분으로 추가 변경사항 나열

### 실제 커밋 메시지 예시

```
채팅 대회 참가 신청/취소 플로우 + 내 정보 조회 + 테스트 인프라
홈 채팅 UI 개선: 헤더 제거, 입력창 하단 고정, 푸터 숨김
홈 페이지를 전체 화면 채팅 UI로 전환
RESTRICTED 사용자 역할 추가 (레벨 0, USER 하위)
admin/users 권한 변경 RLS 우회 및 즉시 UI 반영
```

### 메시지 작성 규칙

1. **첫 줄**: 핵심 변경 요약 (50자 내외 권장)
2. **복합 변경**: `+` 또는 `,`로 관련 변경사항 연결
3. **세부 설명**: 괄호 `()` 안에 부가 정보
4. **동사 형태**: `추가`, `개선`, `수정`, `제거`, `전환`, `통합` 등

## 워크플로우

### Step 1: 변경사항 수집

다음 명령어를 **병렬로** 실행하여 현재 상태를 파악한다:

```bash
# 작업 트리 상태 (untracked 포함)
git status

# staged + unstaged 변경 내용
git diff HEAD

# 최근 커밋 메시지 스타일 참조
git log --oneline -5
```

### Step 2: 변경사항 분석

수집된 diff를 분석하여 다음을 파악한다:

1. **변경 유형**: 신규 기능 / 기능 개선 / 버그 수정 / 리팩토링 / 설정 변경
2. **영향 범위**: 변경된 파일들의 도메인 (UI, API, DB, 인증 등)
3. **핵심 변경**: 가장 중요한 변경이 무엇인지
4. **부수 변경**: 핵심 변경에 딸린 보조 변경사항

### Step 3: 커밋 메시지 작성

분석 결과를 바탕으로 커밋 메시지를 작성한다.

**인수($ARGUMENTS)가 제공된 경우**: 인수를 커밋 메시지의 힌트로 활용하되, diff 분석 결과와 조합하여 최종 메시지를 결정한다.

**인수가 없는 경우**: diff 분석만으로 메시지를 자동 생성한다.

### Step 4: 스테이징 및 커밋

1. **민감 파일 체크**: `.env`, `credentials`, 시크릿 파일이 포함되어 있으면 경고하고 제외
2. **파일별 스테이징**: `git add -A` 대신 관련 파일을 명시적으로 `git add`
3. **커밋 실행**: HEREDOC 형식으로 커밋 메시지 전달

```bash
git commit -m "$(cat <<'EOF'
커밋 메시지 여기

Co-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>
EOF
)"
```

4. **커밋 후 상태 확인**: `git status`로 커밋 성공 여부 검증

### Step 5: 결과 보고

```markdown
## 커밋 완료

**커밋**: `<hash>` <메시지>
**변경 파일**: N개
**삽입/삭제**: +X / -Y
```

## 주의사항

- `git push`는 절대 자동 실행하지 않는다 (사용자 요청 시에만)
- pre-commit hook 실패 시 `--no-verify` 사용 금지 — 문제를 수정 후 새 커밋 생성
- `--amend` 사용 금지 (사용자 명시 요청 제외)
- 빈 커밋 생성 금지 (변경사항 없으면 안내만)

ARGUMENTS: $ARGUMENTS
